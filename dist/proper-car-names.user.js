// ==UserScript==
// @name         Proper Car Names
// @namespace    diicot
// @version      1.0.0
// @author       mavri [2402357]
// @description  Who the fuck likes the new names? (except the tribute ones)
// @match        www.torn.com/loader.php?sid=racing
// ==/UserScript==

(function () {
	'use strict';

	const I=(n,t)=>Array.prototype.slice.call(n,t);let N=null;typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?N=self:typeof global<"u"?N=global:window&&(N=window);const x=N,k=N.document,_=["load","loadend","loadstart"],V=["progress","abort","error","timeout"],K=n=>["returnValue","totalSize","position"].includes(n),H=function(n,t){for(let e in n){if(K(e))continue;const o=n[e];try{t[e]=o;}catch{}}return t},U=function(n,t,e){const o=r=>function(s){const i={};for(let u in s){if(K(u))continue;const d=s[u];i[u]=d===t?e:d;}return e.dispatchEvent(r,i)};for(let r of Array.from(n))e._has(r)&&(t[`on${r}`]=o(r));},J=function(n){if(k&&k.createEventObject!=null){const t=k.createEventObject();return t.type=n,t}try{return new Event(n)}catch{return {type:n}}},j=function(n){let t={};const e=r=>t[r]||[],o={};return o.addEventListener=function(r,s,i){t[r]=e(r),!(t[r].indexOf(s)>=0)&&(i=i===void 0?t[r].length:i,t[r].splice(i,0,s));},o.removeEventListener=function(r,s){if(r===void 0){t={};return}s===void 0&&(t[r]=[]);const i=e(r).indexOf(s);i!==-1&&e(r).splice(i,1);},o.dispatchEvent=function(){const r=I(arguments),s=r.shift();n||(r[0]=H(r[0],J(s)),Object.defineProperty(r[0],"target",{writable:!1,value:this}));const i=o[`on${s}`];i&&i.apply(o,r);const u=e(s).concat(e("*"));for(let d=0;d<u.length;d++)u[d].apply(o,r);},o._has=r=>!!(t[r]||o[`on${r}`]),n&&(o.listeners=r=>I(e(r)),o.on=o.addEventListener,o.off=o.removeEventListener,o.fire=o.dispatchEvent,o.once=function(r,s){var i=function(){return o.off(r,i),s.apply(null,arguments)};return o.on(r,i)},o.destroy=()=>t={}),o},Q=`\r
`,ee=function(n){return Object.entries(n).map(([o,r])=>`${o.toLowerCase()}: ${r}`).join(Q)},te=function(n,t){const e=n.split(Q);t==null&&(t={});for(let o of e)if(/([^:]+):\s*(.+)/.test(o)){const r=RegExp.$1!=null?RegExp.$1.toLowerCase():void 0,s=RegExp.$2;t[r]==null&&(t[r]=s);}return t},ne=function(n,t){switch(typeof n){case"object":return ee(n);case"string":return te(n,t)}return []};var F={convert:ne};const M=j(!0),$=n=>n===void 0?null:n,L=x.XMLHttpRequest,R=function(){const t=new L,e={};let o=null,r,s,i;var u=0;const d=function(){if(i.status=o||t.status,o!==-1&&(i.statusText=t.statusText),o!==-1){const c=F.convert(t.getAllResponseHeaders());for(let f in c){const h=c[f];if(!i.headers[f]){const p=f.toLowerCase();i.headers[p]=h;}}return}},v=function(){if(!t.responseType||t.responseType==="text"){i.text=t.responseText,i.data=t.responseText;try{i.xml=t.responseXML;}catch{}}else t.responseType==="document"?(i.xml=t.responseXML,i.data=t.responseXML):i.data=t.response;"responseURL"in t&&(i.finalUrl=t.responseURL);},m=function(){a.status=i.status,a.statusText=i.statusText;},T=function(){"text"in i&&(a.responseText=i.text),"xml"in i&&(a.responseXML=i.xml),"data"in i&&(a.response=i.data),"finalUrl"in i&&(a.responseURL=i.finalUrl);},l=function(){r||a.dispatchEvent("load",{}),a.dispatchEvent("loadend",{}),r&&(a.readyState=0);},g=function(c){for(;c>u&&u<4;)a.readyState=++u,u===1&&a.dispatchEvent("loadstart",{}),u===2&&m(),u===4&&(m(),T()),a.dispatchEvent("readystatechange",{}),u===4&&(e.async===!1?l():setTimeout(l,0));},w=function(c){if(c!==4){g(c);return}const f=M.listeners("after");var h=function(){if(f.length>0){const p=f.shift();p.length===2?(p(e,i),h()):p.length===3&&e.async?p(e,i,h):h();}else g(4);};h();};var a=j();e.xhr=a,t.onreadystatechange=function(c){try{t.readyState===2&&d();}catch{}t.readyState===4&&(s=!1,d(),v()),w(t.readyState);};const S=function(){r=!0;};a.addEventListener("error",S),a.addEventListener("timeout",S),a.addEventListener("abort",S),a.addEventListener("progress",function(c){u<3?w(3):t.readyState<=3&&a.dispatchEvent("readystatechange",{});}),"withCredentials"in t&&(a.withCredentials=!1),a.status=0;for(let c of Array.from(V.concat(_)))a[`on${c}`]=null;if(a.open=function(c,f,h,p,A){u=0,r=!1,s=!1,e.headers={},e.headerNames={},e.status=0,e.method=c,e.url=f,e.async=h!==!1,e.user=p,e.pass=A,i={},i.headers={},w(1);},a.send=function(c){let f,h;for(f of ["type","timeout","withCredentials"])h=f==="type"?"responseType":f,h in a&&(e[f]=a[h]);e.body=c;const p=function(){U(V,t,a),a.upload&&U(V.concat(_),t.upload,a.upload),s=!0,t.open(e.method,e.url,e.async,e.user,e.pass);for(f of ["type","timeout","withCredentials"])h=f==="type"?"responseType":f,f in e&&(t[h]=e[f]);for(let E in e.headers){const O=e.headers[E];E&&t.setRequestHeader(E,O);}t.send(e.body);},A=M.listeners("before");var G=function(){if(!A.length)return p();const E=function(b){if(typeof b=="object"&&(typeof b.status=="number"||typeof i.status=="number")){H(b,i),"data"in b||(b.data=b.response||b.text),w(4);return}G();};E.head=function(b){H(b,i),w(2);},E.progress=function(b){H(b,i),w(3);};const O=A.shift();O.length===1?E(O(e)):O.length===2&&e.async?O(e,E):E();};G();},a.abort=function(){o=-1,s?t.abort():a.dispatchEvent("abort",{});},a.setRequestHeader=function(c,f){const h=c!=null?c.toLowerCase():void 0,p=e.headerNames[h]=e.headerNames[h]||c;e.headers[p]&&(f=e.headers[p]+", "+f),e.headers[p]=f;},a.getResponseHeader=c=>$(i.headers[c?c.toLowerCase():void 0]),a.getAllResponseHeaders=()=>$(F.convert(i.headers)),t.overrideMimeType&&(a.overrideMimeType=function(){t.overrideMimeType.apply(t,arguments);}),t.upload){let c=j();a.upload=c,e.upload=c;}return a.UNSENT=0,a.OPENED=1,a.HEADERS_RECEIVED=2,a.LOADING=3,a.DONE=4,a.response="",a.responseText="",a.responseXML=null,a.readyState=0,a.statusText="",a};R.UNSENT=0;R.OPENED=1;R.HEADERS_RECEIVED=2;R.LOADING=3;R.DONE=4;var B={patch(){L&&(x.XMLHttpRequest=R);},unpatch(){L&&(x.XMLHttpRequest=L);},Native:L,Xhook:R};function oe(n,t){var e={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&t.indexOf(o)<0&&(e[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(n);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(n,o[r])&&(e[o[r]]=n[o[r]]);return e}function re(n,t,e,o){function r(s){return s instanceof e?s:new e(function(i){i(s);})}return new(e||(e=Promise))(function(s,i){function u(m){try{v(o.next(m));}catch(T){i(T);}}function d(m){try{v(o.throw(m));}catch(T){i(T);}}function v(m){m.done?s(m.value):r(m.value).then(u,d);}v((o=o.apply(n,[])).next());})}const C=x.fetch;function ie(n){const t=["method","headers","body","mode","credentials","cache","redirect","referrer","referrerPolicy","integrity","keepalive","signal","url"];let e={};return t.forEach(o=>e[o]=n[o]),e}function W(n){return n instanceof Headers?Z([...n.entries()]):Array.isArray(n)?Z(n):n}function Z(n){return n.reduce((t,[e,o])=>(t[e]=o,t),{})}const z=function(n,t={headers:{}}){let e=Object.assign(Object.assign({},t),{isFetch:!0});if(n instanceof Request){const s=ie(n),i=Object.assign(Object.assign({},W(s.headers)),W(e.headers));e=Object.assign(Object.assign(Object.assign({},s),t),{headers:i,acceptedRequest:!0});}else e.url=n;const o=M.listeners("before"),r=M.listeners("after");return new Promise(function(s,i){let u=s;const d=function(l){if(!r.length)return u(l);const g=r.shift();return g.length===2?(g(e,l),d(l)):g.length===3?g(e,l,d):d(l)},v=function(l){if(l!==void 0){const g=new Response(l.body||l.text,l);s(g),d(g);return}m();},m=function(){if(!o.length){T();return}const l=o.shift();if(l.length===1)return v(l(e));if(l.length===2)return l(e,v)},T=()=>re(this,void 0,void 0,function*(){const{url:l,isFetch:g,acceptedRequest:w}=e,a=oe(e,["url","isFetch","acceptedRequest"]);return n instanceof Request&&a.body instanceof ReadableStream&&(a.body=yield new Response(a.body).text()),C(l,a).then(S=>d(S)).catch(function(S){return u=i,d(S),i(S)})});m();})};var D={patch(){C&&(x.fetch=z);},unpatch(){C&&(x.fetch=C);},Native:C,Xhook:z};const y=M;y.EventEmitter=j;y.before=function(n,t){if(n.length<1||n.length>2)throw "invalid hook";return y.on("before",n,t)};y.after=function(n,t){if(n.length<2||n.length>3)throw "invalid hook";return y.on("after",n,t)};y.enable=function(){B.patch(),D.patch();};y.disable=function(){B.unpatch(),D.unpatch();};y.XMLHttpRequest=B.Native;y.fetch=D.Native;y.headers=F.convert;y.enable();const q={"Yotsuhada EVX":"Mitsubishi Evo X","Stålhög 860":"Volvo 850","Alpha Milano 156":"Alfa Romeo 156","Bavaria X5":"BMW X5","Coche Basurero":"Seat Leon Cupra","Bedford Nova":"Vauxhall Astra GSI","Verpestung Sport":"Volkswagen Golf GTI","Echo S3":"Audi S3","Volt RS":"Ford Focus RS","Edomondo S2":"Honda S2000","Nano Cavalier":"Mini Cooper S","Colina Tanprice":"Ford Sierra Cosworth","Cosmos EX":"Lotus Exige","Bedford Racer":"Vauxhall Corsa","Sturmfahrt 111":"Porsche 911 GT3","Tsubasa Impressor":"Subaru Impreza STI","Wington GGU":"TVR Sagaris","Weston Marlin 177":"Aston Martin One-77","Echo R8":"Audi R8","Stormatti Casteon":"Bugatti Veyron","Lolo 458":"Ferrari 458","Lambrini Torobravo":"Lamborghini Gallardo","Veloria LFA":"Lexus LFA","Mercia SLR":"Mercedes SLR","Zaibatsu GT-R":"Nissan GT-R","Edomondo Localé":"Honda Civic","Edomondo NSX":"Honda NSX","Echo Quadrato":"Audi TT Quattro","Bavaria M5":"BMW M5","Bavaria Z8":"BMW Z8","Chevalier CZ06":"Chevrolet Corvette Z06","Dart Rampager":"Dodge Charger","Knight Firebrand":"Pontiac Firebird","Volt GT":"Ford GT","Invader H3":"Hummer H3","Echo S4":"Audi S4","Edomondo IR":"Honda Integra R","Edomondo ACD":"Honda Accord","Tabata RM2":"Toyota MR2","Verpestung Insecta":"Volkswagen Beetle","Chevalier CVR":"Chevrolet Cavalier","Volt MNG":"Ford Mustang",Trident:"Reliant Robin","Oceania SS":"Holden SS","Limoen Saxon":"Citroen Saxo","Nano Pioneer":"Classic Mini","Vita Bravo":"Fiat Punto","Zaibatsu Macro":"Nissan Micra","Çagoutte 10-6":"Peugeot 106","Papani Colé":"Renault Clio"};function P(n,t){return new Promise((e,o)=>{let r;if(document.querySelectorAll(n).length)return e(document.querySelector(n));const s=new MutationObserver(()=>{if(document.querySelectorAll(n).length)return s.disconnect(),r!=null&&clearTimeout(r),e(document.querySelector(n))});s.observe(document.body,{childList:!0,subtree:!0}),t&&(r=setTimeout(()=>{s.disconnect(),e(null);},t));})}async function Y(){await P(".car img",15e3);const n=document.querySelectorAll(".car img");if(!n.length){console.warn("Failed to find car images");return}n.forEach(t=>{const e=q[t.title.trim()]||t.title;t.title=e;});}async function X(){await P(".model",1e4),document.querySelectorAll(".model").forEach(t=>{var r;const e=t.children[0];if(!e){console.warn("No child element found in",t);return}const o=(r=e.textContent)==null?void 0:r.trim();if(o){const s=q[o];s&&(e.textContent=s);}});}async function ae(){var e;const n=await P(".msg.right-round b");if(!n){console.warn("Failed to find upgrade element");return}const t=(e=n.textContent)==null?void 0:e.trim();if(t){const o=q[t];o&&(n.textContent=o);}}y.after((n,t)=>{const e=n.url;if(e.includes("racing")){if(e.includes("&tab=parts&section=addParts")){ae();return}if(e.includes("sid=racing&tab=race")){X(),Y();return}X();}});X();Y();

})();